{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 */2 * * *"
            }
          ]
        }
      },
      "id": "20dafcad-b67d-4dd1-bb1a-cdd02ec69b4e",
      "name": "Tweet Schedule - Every 2 Hours",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        2256,
        4256
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "coinmarketcap_api_key",
              "value": "e2020eb756b049e8b4501485220ef1eb",
              "type": "string"
            },
            {
              "id": "id-2",
              "name": "coingecko_api_key",
              "value": "CG-TH8Xurv7ih7MbSXESG6PTEQQ",
              "type": "string"
            },
            {
              "id": "id-3",
              "name": "cryptocompare_api_key",
              "value": "f3e0be8136c2d3a2c32569fc863d223931f5fd6971b2c47ce7d19c0c78abdfdd",
              "type": "string"
            },
            {
              "id": "id-4",
              "name": "newsdata_api_key",
              "value": "pub_693b145d29e34f5684aad8beee0897d0",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "42d2201b-0f4a-41f2-8e93-4670b836927c",
      "name": "Workflow Configuration",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2480,
        4256
      ]
    },
    {
      "parameters": {
        "url": "https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest?limit=10",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-CMC_PRO_API_KEY",
              "value": "={{ $('Workflow Configuration').first().json.coinmarketcap_api_key }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "9aed27d7-d72e-4654-9687-9a1b52473e04",
      "name": "Fetch CoinMarketCap Data",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2704,
        3840
      ]
    },
    {
      "parameters": {
        "url": "https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-cg-demo-api-key",
              "value": "={{ $('Workflow Configuration').first().json.coingecko_api_key }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "6231ff20-bfa7-468c-b14c-ff2f027ade54",
      "name": "Fetch CoinGecko Data",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2704,
        4032
      ]
    },
    {
      "parameters": {
        "url": "https://min-api.cryptocompare.com/data/top/mktcapfull?limit=10&tsym=USD",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "authorization",
              "value": "=Apikey {{ $('Workflow Configuration').first().json.cryptocompare_api_key }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "255f475e-4e69-453c-a675-466febae61fc",
      "name": "Fetch CryptoCompare Data",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2704,
        4224
      ]
    },
    {
      "parameters": {
        "url": "={{ 'https://newsdata.io/api/1/news?apikey=' + $('Workflow Configuration').first().json.newsdata_api_key + '&q=crypto OR bitcoin OR ethereum&language=en&category=business' }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "05b9bba2-38cf-484f-bb6a-002c7bf98608",
      "name": "Fetch NewsData Crypto News",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2704,
        4416
      ]
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "id": "01502b3f-7ab6-4439-90b8-972627595b47",
      "name": "Merge All Crypto Data",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        3024,
        4016
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "market_summary",
              "value": "=Create a short crypto market update tweet.\nMention BTC or ETH movement.\nKeep under 280 characters.\nAdd 2 hashtags.",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "91ac97db-7614-4d7e-9121-2beac88262b2",
      "name": "Format Market Data for AI",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3248,
        4016
      ]
    },
    {
      "parameters": {
        "modelId": {
          "mode": "id",
          "value": "gpt-4o-mini"
        },
        "responses": {
          "values": [
            {
              "content": "={{ $json.market_summary }}"
            }
          ]
        },
        "builtInTools": {},
        "options": {
          "instructions": "Write a sharp, engaging crypto tweet.\nShort, trader-style tone."
        }
      },
      "id": "9e12ad39-9e21-4ca5-8ef3-be27a2350531",
      "name": "Generate Tweet Content",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2.1,
      "position": [
        3440,
        4016
      ],
      "credentials": {
        "openAiApi": {
          "id": "M0eECNX0rlwib3O3",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "content",
              "value": "={{ $json.output[0].content }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": false,
        "options": {}
      },
      "id": "f4a5b6c7-d8e9-f0a1-b2c3-d4e5f6a7b8c9",
      "name": "Remap Tweet Output",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3632,
        4016
      ]
    },
    {
      "parameters": {
        "text": "={{ $json.content[0].text }}",
        "additionalFields": {}
      },
      "id": "53b0b98c-2b35-46fd-bf54-ce23e74dea3c",
      "name": "Post Tweet",
      "type": "n8n-nodes-base.twitter",
      "typeVersion": 2,
      "position": [
        3824,
        4016
      ],
      "credentials": {
        "twitterOAuth2Api": {
          "id": "sIWMbXLkar0z6tEZ",
          "name": "X account"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 8,14,20 * * *"
            }
          ]
        }
      },
      "id": "6b6f4a6a-adec-4bed-9216-b42fa6141742",
      "name": "DM Schedule - 3 Times Daily",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        2256,
        4864
      ],
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "timeOfDay",
              "value": "={{ new Date().getHours() < 12 ? 'morning' : new Date().getHours() < 18 ? 'afternoon' : 'evening' }}",
              "type": "string"
            },
            {
              "id": "id-2",
              "name": "sheetsDocumentId",
              "value": "1QC5Dl9GS1H1ejeLBmZ27B1wsiKLfUbxnD9gmmyi3D5E",
              "type": "string"
            },
            {
              "id": "id-3",
              "name": "sheetsName",
              "value": "ContactedUsers",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "f320b89f-ec12-4821-888a-fcffeb18c22a",
      "name": "DM Workflow Configuration",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2480,
        4864
      ],
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "targetUsers",
              "value": "[\"@cryptotrader_us1\", \"@blockchain_uae\", \"@defi_trader_ny\", \"@dubai_crypto_pro\", \"@btc_enthusiast_tx\", \"@eth_investor_dubai\", \"@crypto_whale_miami\", \"@nft_collector_abudhabi\", \"@altcoin_hunter_ca\", \"@web3_builder_uae\"]",
              "type": "array"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "6b0049e4-444a-4bc0-9ee2-595fe3730841",
      "name": "Define Target Users",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2704,
        4960
      ],
      "disabled": true
    },
    {
      "parameters": {
        "fieldToSplitOut": "targetUsers",
        "options": {}
      },
      "id": "78026075-447e-423e-8b08-53f9a12b3b1b",
      "name": "Split Users to Array",
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2944,
        4944
      ],
      "disabled": true
    },
    {
      "parameters": {
        "modelId": {
          "mode": "id",
          "value": "gpt-4o-mini"
        },
        "responses": {
          "values": [
            {
              "content": "=Generate a DM for username: {{ $json.targetUsers }}"
            }
          ]
        },
        "builtInTools": {},
        "options": {
          "instructions": "You are a friendly crypto trading professional reaching out to traders.\n\nYour task:\n1. Generate ONE short, professional DM (max 200 characters)\n2. Vary the message based on time of day\n3. Be friendly but professional\n4. NO links, NO spam, NO sales pitch\n5. Ask about their trading approach (manual vs automated)\n6. Use their first name if available\n\nExamples:\n- \"Hi [name], do you execute crypto trades manually or via automation?\"\n- \"Hey [name], quick question â€” are your crypto trades fully automated or discretionary?\"\n- \"Hi [name], are you currently using any trading bots or trading manually?\"\n\nReturn ONLY the DM text, nothing else."
        }
      },
      "id": "b523115b-255e-48d4-a922-d8fb52aa808c",
      "name": "Generate DM Content",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2.1,
      "position": [
        3248,
        4944
      ],
      "credentials": {
        "openAiApi": {
          "id": "M0eECNX0rlwib3O3",
          "name": "OpenAi account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "username",
              "value": "={{ $json.targetUsers }}",
              "type": "string"
            },
            {
              "id": "4bdc418f-5ce6-4327-9732-f46601698a87",
              "name": "text",
              "value": "={{ $json.content[0].text }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "b7ab80d0-fb25-49c3-a6e6-86feb4960604",
      "name": "Merge Username and DM Text",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3536,
        4960
      ],
      "disabled": true
    },
    {
      "parameters": {
        "resource": "directMessage",
        "user": {
          "__rl": true,
          "mode": "username",
          "value": "={{ $json.username }}"
        },
        "text": "={{ $json.text }}",
        "additionalFields": {}
      },
      "id": "b634fd41-6324-4d40-bc39-7c9472068d51",
      "name": "Send DM",
      "type": "n8n-nodes-base.twitter",
      "typeVersion": 2,
      "position": [
        3744,
        4976
      ],
      "credentials": {
        "twitterOAuth2Api": {
          "id": "cKUrSQL7uRiAnFcX",
          "name": "X account 3"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "amount": 2.5
      },
      "id": "3d673280-3576-4380-a212-70b751cde21d",
      "name": "Wait 2-3 Seconds",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3968,
        4960
      ],
      "webhookId": "212a9922-0c8b-4800-a76b-a284652e2fa7",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('DM Workflow Configuration').first().json.sheetsDocumentId }}"
        },
        "sheetName": {
          "__rl": true,
          "mode": "name",
          "value": "={{ $('DM Workflow Configuration').first().json.sheetsName }}"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "username": "={{ $json.username }}",
            "contacted_at": "={{ $now.toISO() }}"
          },
          "matchingColumns": [
            "username"
          ],
          "schema": [
            {
              "id": "username",
              "displayName": "username",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "contacted_at",
              "displayName": "contacted_at",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": false,
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "d2030e97-b77e-4ab0-badc-91f03cb79707",
      "name": "Log Contacted User",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4272,
        4928
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "gQxuu7iITcScbxR5",
          "name": "Google Sheets account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "resource": "user",
        "user": {
          "__rl": true,
          "value": "{{ $json.targetUsers.replace('@','') }}",
          "mode": "username"
        }
      },
      "type": "n8n-nodes-base.twitter",
      "typeVersion": 2,
      "position": [
        2816,
        4832
      ],
      "id": "d462dd19-9311-49c5-9413-906213076db6",
      "name": "Get User1",
      "credentials": {
        "twitterOAuth2Api": {
          "id": "cKUrSQL7uRiAnFcX",
          "name": "X account 3"
        }
      },
      "disabled": true
    }
  ],
  "pinData": {},
  "connections": {
    "Tweet Schedule - Every 2 Hours": {
      "main": [
        [
          {
            "node": "Workflow Configuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Workflow Configuration": {
      "main": [
        [
          {
            "node": "Fetch CoinMarketCap Data",
            "type": "main",
            "index": 0
          },
          {
            "node": "Fetch CoinGecko Data",
            "type": "main",
            "index": 0
          },
          {
            "node": "Fetch CryptoCompare Data",
            "type": "main",
            "index": 0
          },
          {
            "node": "Fetch NewsData Crypto News",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch CoinMarketCap Data": {
      "main": [
        [
          {
            "node": "Merge All Crypto Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch CoinGecko Data": {
      "main": [
        [
          {
            "node": "Merge All Crypto Data",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Fetch CryptoCompare Data": {
      "main": [
        [
          {
            "node": "Merge All Crypto Data",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Fetch NewsData Crypto News": {
      "main": [
        [
          {
            "node": "Merge All Crypto Data",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "Merge All Crypto Data": {
      "main": [
        [
          {
            "node": "Format Market Data for AI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Market Data for AI": {
      "main": [
        [
          {
            "node": "Generate Tweet Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Tweet Content": {
      "main": [
        [
          {
            "node": "Remap Tweet Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remap Tweet Output": {
      "main": [
        [
          {
            "node": "Post Tweet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DM Schedule - 3 Times Daily": {
      "main": [
        [
          {
            "node": "DM Workflow Configuration",
            "type": "main",
            "index": 0
          },
          {
            "node": "Split Users to Array",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DM Workflow Configuration": {
      "main": [
        [
          {
            "node": "Define Target Users",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Define Target Users": {
      "main": [
        [
          {
            "node": "Split Users to Array",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Users to Array": {
      "main": [
        [
          {
            "node": "Generate DM Content",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get User1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate DM Content": {
      "main": [
        [
          {
            "node": "Merge Username and DM Text",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Username and DM Text": {
      "main": [
        [
          {
            "node": "Send DM",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send DM": {
      "main": [
        [
          {
            "node": "Wait 2-3 Seconds",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 2-3 Seconds": {
      "main": [
        [
          {
            "node": "Log Contacted User",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get User1": {
      "main": [
        [
          {
            "node": "Generate DM Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  ],
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "df858840-bf4f-44a0-bdfe-b591c41d3e51",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "c2b5372e2e56d97d48358663b6ce39a34be03b71304ae7d8eee22217e70a256c"
  },
  "id": "Z4uw6fjzUs6IyyN6",
  "tags": []
}
